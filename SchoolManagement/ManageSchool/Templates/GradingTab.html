<!DOCTYPE html>
<html lang="en">
    {% load static  %}
    <link rel="stylesheet" href="{% static 'gradingtab.css' %}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grading Tab</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
      <div class="setParameters">
          <label>
                Enter Student ID
              <input type="text" id="studentId">
          </label>

          <label>
              Check Correct Name
              <input type="text" readonly>
          </label>

          <label>
                Check Correct Class
                <input type="text" readonly>
          </label>

                 <label>Select subject to evaluate</label>
                    <select id="subject">
                        <option value="Maths">Maths</option>
                        <option value="Science">Science</option>
                        <option value="English">English</option>
                        <option value="Social">Social</option>
                    </select>
      </div>

 <!--marking table-->
        <div class="gradingTable">
            <table class="table table-bordered">
               <thead>
                <tr>
                    <th>Subject</th>
                    <th>Sheet DivisionNo</th>
                    <th>Max mark</th>
                    <th>Marks obtained</th>
                    <th>Total Marks</th>
                    <th>Status</th>
                </tr>
               </thead>
                <tbody>
                <tr>
                    <td rowspan="5">Math</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>30</td>
                    <td><textarea type="" placeholder="Enter marks like this 10+20+30" class="marksTextarea"></textarea></td>
                    <td class="totalMarks"></td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>30</td>
                    <td><textarea type="" placeholder="Enter marks like this 10+20+30" class="marksTextarea"></textarea></td>
                    <td class="totalMarks"></td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>40</td>
                     <td><textarea type="" placeholder="Enter marks like this 10+20+30" class="marksTextarea"></textarea></td>
                    <td class="totalMarks"></td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>10</td>
                     <td><textarea type="" placeholder="Enter marks like this 10+20+30" class="marksTextarea"></textarea></td>
                    <td class="totalMarks"></td>
                </tr>
                </tbody>
            </table>
        </div>

 <script>
   document.addEventListener('keypress', function (e) {
    if (e.target.classList.contains('marksTextarea')) {
        const regex = /[0-9+\-]/;
        if (!regex.test(e.key)) {
            e.preventDefault();
        }
    }
});

document.addEventListener('keydown', function (e) {
    if (e.target.classList.contains('marksTextarea') && e.key === 'Enter') {
        e.preventDefault();
        try {
            const totalMarks = eval(e.target.value);
            const totalMarksCell = e.target.closest('tr').querySelector('.totalMarks');
            totalMarksCell.innerText = totalMarks;
        } catch (error) {
            const totalMarksCell = e.target.closest('tr').querySelector('.totalMarks');
            totalMarksCell.innerText = 'Invalid input';
        }
    }
});

document.addEventListener('input', function (e) {
    if (e.target.classList.contains('marksTextarea')) {
        try {
            const totalMarks = eval(e.target.value);
            const row = e.target.closest('tr');
            const maxMarkCell = row.querySelector('td:nth-child(3)');
            const maxMark = parseInt(maxMarkCell.innerText, 10);
            const totalMarksCell = row.querySelector('.totalMarks');

            if (totalMarks > maxMark) {
                alert('Total marks exceed the maximum mark for this division.');
                totalMarksCell.innerText = '';
            } else {
                totalMarksCell.innerText = totalMarks;
            }
        } catch (error) {
            const totalMarksCell = e.target.closest('tr').querySelector('.totalMarks');
            totalMarksCell.innerText = 'Invalid input';
        }
    }
});
    </script>
</body>
</html>